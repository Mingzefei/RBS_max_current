(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     31843,        881]
NotebookOptionsPosition[     29925,        840]
NotebookOutlinePosition[     30473,        860]
CellTagsIndexPosition[     30430,        857]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Ao", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "0", " ", ",", "0", " ", 
       ",", "0", ",", " ", "0", " ", ",", "0", " ", ",", "1"}], "}"}], "}"}], 
    "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ab", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",", 
        RowBox[{"-", "1"}], " ", ",", "0", ",", " ", "0", ",", " ", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",", 
        RowBox[{"-", "1"}], " ", ",", "0", ",", " ", "0"}], "}"}]}], "}"}], 
    "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"As", "=", 
    RowBox[{"SparseArray", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", " ", "1"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", "1"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}], "\[Rule]", "1"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3", ",", "2"}], "}"}], "\[Rule]", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3", ",", "4"}], "}"}], "\[Rule]", "1"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"4", ",", "3"}], "}"}], "\[Rule]", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"5", ",", "5"}], "}"}], "\[Rule]", "1"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"6", ",", "4"}], "}"}], "\[Rule]", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"6", ",", "6"}], "}"}], "\[Rule]", "1"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"7", ",", "5"}], "}"}], "\[Rule]", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"7", ",", "6"}], "}"}], "\[Rule]", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"7", ",", "7"}], "}"}], "\[Rule]", "1"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"8", ",", "7"}], "}"}], "\[Rule]", 
        RowBox[{"-", "1"}]}]}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
     "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6", ",", "x7", 
      ",", "x8"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "Ro"], 
     RowBox[{"Ao", ".", 
      RowBox[{"Ao", "\[Transpose]"}]}]}], "+", 
    RowBox[{
     FractionBox["1", "rb"], 
     RowBox[{"Ab", ".", 
      RowBox[{"Ab", "\[Transpose]"}]}]}], "+", 
    RowBox[{
     FractionBox["1", "rs"], 
     RowBox[{"As", ".", 
      RowBox[{"As", "\[Transpose]"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Det", "[", "Y", "]"}]}], "Input",
 CellChangeTimes->{{3.886646670251648*^9, 3.886646709026687*^9}, {
  3.8866467921955004`*^9, 3.886646830514224*^9}, {3.886646867830593*^9, 
  3.886646912911045*^9}, {3.8866469999405684`*^9, 3.8866471695373344`*^9}, {
  3.8866476739519234`*^9, 3.88664773660387*^9}, {3.8866496846897626`*^9, 
  3.88664968490372*^9}, {3.8866501746045027`*^9, 3.8866501767756023`*^9}, {
  3.8866521069777627`*^9, 3.886652111182128*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"15836539-bacd-43c2-b76c-283ee17f8f33"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.886661466907892*^9, 3.886661492291457*^9}},
 CellLabel->"Out[6]=",ExpressionUUID->"e920b8b3-26bc-402d-87e4-d3271604ea4b"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
     "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ao", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "0", " ", ",", "0", " ", 
       ",", "0", ",", " ", "0", " ", ",", "0"}], "}"}], "}"}], 
    "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ab", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",", 
        RowBox[{"-", "1"}], " ", ",", "0", ",", " ", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",", 
        RowBox[{"-", "1"}], " ", ",", "0"}], "}"}]}], "}"}], 
    "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"As", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", " ", "1"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"3", ",", "2"}], "}"}], "\[Rule]", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"3", ",", "4"}], "}"}], "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"4", ",", "3"}], "}"}], "\[Rule]", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"5", ",", "5"}], "}"}], "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"6", ",", "4"}], "}"}], "\[Rule]", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"6", ",", "6"}], "}"}], "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"7", ",", "5"}], "}"}], "\[Rule]", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"7", ",", "6"}], "}"}], "\[Rule]", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"7", ",", "7"}], "}"}], "\[Rule]", "1"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"INb1", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], "}"}], "\[Transpose]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "=", 
   RowBox[{"Inverse", "[", 
    RowBox[{
     RowBox[{
      FractionBox["1", "Ro"], 
      RowBox[{"Ao", ".", 
       RowBox[{"Ao", "\[Transpose]"}]}]}], "+", 
     RowBox[{
      FractionBox["1", "rb"], 
      RowBox[{"Ab", ".", 
       RowBox[{"Ab", "\[Transpose]"}]}]}], "+", 
     RowBox[{
      FractionBox["1", "rs"], 
      RowBox[{"As", ".", "x", ".", 
       RowBox[{"As", "\[Transpose]"}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Un", "=", 
   RowBox[{
    RowBox[{
     FractionBox["ub", "rb"], 
     RowBox[{"R", ".", "Ab", ".", "INb1"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Iout", "=", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Ao", "\[Transpose]"}], ".", "Un"}], "Ro"], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ib", "=", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"Ab", "\[Transpose]"}], ".", "Un"}], "-", 
      RowBox[{"ub", "*", "INb1"}]}], "rb"], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Is", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"x", ".", 
      RowBox[{"As", "\[Transpose]"}], ".", "Un"}], "rs"], "//", 
    "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.886649603329274*^9, 3.8866496654068756`*^9}, {
   3.8866497623596587`*^9, 3.8866498044894323`*^9}, {3.886649837383353*^9, 
   3.8866498519980087`*^9}, {3.886650209335149*^9, 3.8866502388973827`*^9}, {
   3.8866502994127717`*^9, 3.8866504381029725`*^9}, {3.8866504810896873`*^9, 
   3.8866505376880894`*^9}, {3.88665057903473*^9, 3.886650612848609*^9}, {
   3.8866507059333987`*^9, 3.886650786201231*^9}, {3.8866508340715714`*^9, 
   3.886650868616346*^9}, {3.886651036829621*^9, 3.886651099987589*^9}, {
   3.886651145625564*^9, 3.886651165096778*^9}, 3.8866512074041834`*^9, {
   3.8866512437383223`*^9, 3.8866512526364183`*^9}, {3.886651319387743*^9, 
   3.886651370290475*^9}, {3.88665142675406*^9, 3.8866515143688145`*^9}, {
   3.8866515467918606`*^9, 3.8866515491431694`*^9}, 3.8866516421251965`*^9, {
   3.8866517774512463`*^9, 3.8866518470548563`*^9}, 3.8866519801263247`*^9, 
   3.8866520615830317`*^9, {3.886652222396472*^9, 3.8866522407736907`*^9}, {
   3.886652295963847*^9, 3.8866523224986105`*^9}, {3.8866526860083556`*^9, 
   3.88665269829556*^9}, {3.8866527288109207`*^9, 3.8866527300231123`*^9}, {
   3.886652895912241*^9, 3.8866529213396273`*^9}, {3.8866586269844027`*^9, 
   3.88665863115779*^9}, {3.88665926658076*^9, 3.8866592704654713`*^9}, 
   3.8866593163854704`*^9, 3.8867377032541313`*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"916ba182-4e61-4b44-8c99-c63675d79ea2"],

Cell[CellGroupData[{

Cell[BoxData["Iout"], "Input",
 CellChangeTimes->{{3.886649603329274*^9, 3.8866496654068756`*^9}, {
   3.8866497623596587`*^9, 3.8866498044894323`*^9}, {3.886649837383353*^9, 
   3.8866498519980087`*^9}, {3.886650209335149*^9, 3.8866502388973827`*^9}, {
   3.8866502994127717`*^9, 3.8866504381029725`*^9}, {3.8866504810896873`*^9, 
   3.8866505376880894`*^9}, {3.88665057903473*^9, 3.886650612848609*^9}, {
   3.8866507059333987`*^9, 3.886650786201231*^9}, {3.8866508340715714`*^9, 
   3.886650868616346*^9}, {3.886651036829621*^9, 3.886651099987589*^9}, {
   3.886651145625564*^9, 3.886651165096778*^9}, 3.8866512074041834`*^9, {
   3.8866512437383223`*^9, 3.8866512526364183`*^9}, {3.886651319387743*^9, 
   3.886651370290475*^9}, {3.88665142675406*^9, 3.8866515143688145`*^9}, {
   3.8866515467918606`*^9, 3.8866515491431694`*^9}, 3.8866516421251965`*^9, {
   3.8866517774512463`*^9, 3.8866518470548563`*^9}, 3.8866519801263247`*^9, {
   3.886652012612502*^9, 3.886652045448117*^9}, {3.8866521251899133`*^9, 
   3.886652164727991*^9}, {3.8866521995488815`*^9, 3.8866522143271685`*^9}, {
   3.8866522516434765`*^9, 3.886652261944021*^9}, {3.8866523297494197`*^9, 
   3.886652332134102*^9}, {3.886652716016114*^9, 3.886652719241416*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"bd316b44-da0a-4370-9528-2d7d7e79d1a5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   FractionBox[
    RowBox[{"4", " ", "rs", " ", "ub"}], 
    RowBox[{
     RowBox[{"4", " ", "rs", " ", 
      RowBox[{"(", 
       RowBox[{"Ro", "+", 
        RowBox[{"3", " ", "rs"}]}], ")"}]}], "+", 
     RowBox[{"rb", " ", 
      RowBox[{"(", 
       RowBox[{"Ro", "+", 
        RowBox[{"5", " ", "rs"}]}], ")"}]}]}]], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.8867333935083055`*^9, 3.8867334255249376`*^9}, 
   3.886737708051813*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"72ee00b5-0234-436f-9e61-ef881dab1424"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ub", "*", "INb1"}]], "Input",
 CellChangeTimes->{{3.8867334286528034`*^9, 3.886733455130376*^9}, 
   3.886733529512864*^9},
 CellLabel->"In[21]:=",ExpressionUUID->"b49b96b8-24f7-49a8-bc12-7c8db10bc356"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Inverse", "[", "R", "]"}], "//", "Simplify"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.886733601254898*^9, 3.8867336112354655`*^9}, {
   3.8867336644464383`*^9, 3.886733682220109*^9}, 3.8867339420918856`*^9, 
   3.886733996596051*^9, 3.8867370137514105`*^9, {3.886737115643891*^9, 
   3.886737119691527*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"831cfb24-50ec-4872-9ec7-ef5efb61628b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ib", "/.", 
   RowBox[{"{", 
    RowBox[{"rs", "\[Rule]", "0"}], "}"}]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8866524128417363`*^9, 3.88665242086617*^9}, {
  3.886652968378028*^9, 3.886652978638122*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"835c9e44-4f5a-40d3-a159-059a4ccf905f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["ub", "rb"]},
     {
      FractionBox["ub", "rb"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8866614670688925`*^9, 3.886661492537154*^9}, 
   3.886731082571046*^9, 3.8867377232428985`*^9},
 CellLabel->
  "Out[44]//MatrixForm=",ExpressionUUID->"e1ece360-c4b8-4549-bcdf-\
94413d59c61d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Ao", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "0", " ", ",", "0", " ", 
       ",", "0", ",", " ", "0", " ", ",", "0"}], "}"}], "}"}], 
    "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ab", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",", 
        RowBox[{"-", "1"}], " ", ",", "0", ",", " ", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",", 
        RowBox[{"-", "1"}], " ", ",", "0"}], "}"}]}], "}"}], 
    "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"As", "=", 
    RowBox[{"SparseArray", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", " ", "1"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", "1"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}], "\[Rule]", "1"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3", ",", "2"}], "}"}], "\[Rule]", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3", ",", "4"}], "}"}], "\[Rule]", "1"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"4", ",", "3"}], "}"}], "\[Rule]", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"5", ",", "5"}], "}"}], "\[Rule]", "1"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"6", ",", "4"}], "}"}], "\[Rule]", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"6", ",", "6"}], "}"}], "\[Rule]", "1"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"7", ",", "5"}], "}"}], "\[Rule]", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"7", ",", "6"}], "}"}], "\[Rule]", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"7", ",", "7"}], "}"}], "\[Rule]", "1"}]}], "}"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{"1", ",", 
        RowBox[{
         RowBox[{"Dimensions", "[", "Ab", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
       "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"Ao", ",", "Ab", ",", 
     RowBox[{"Normal", "[", "As", "]"}], ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        FractionBox["1", "Ro"], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         FractionBox["1", "rb"], ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "Ab", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         FractionBox["1", "rs"], ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "As", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "]"}], ".", 
    "x"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Yn", "=", 
   RowBox[{"A", ".", "Y", ".", 
    RowBox[{"A", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Us", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"-", "ub"}], ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "Ab", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "As", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Is", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "Ab", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "As", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Isn", "=", 
   RowBox[{
    RowBox[{"A", ".", "Y", ".", "Us"}], "-", 
    RowBox[{"A", ".", "Is"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Un", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Inverse", "[", "Yn", "]"}], ".", "Isn"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"A", "\[Transpose]"}], ".", "Un"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ia", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Y", ".", "U"}], "-", 
      RowBox[{"Y", ".", "Us"}], "+", "Is"}], "/.", 
     RowBox[{"{", 
      RowBox[{"rs", "\[Rule]", "0"}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"io", "=", 
   RowBox[{"First", "[", 
    RowBox[{"Ia", "//", "Flatten"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ib", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"Part", "[", 
     RowBox[{"Ia", ",", 
      RowBox[{"2", ";;", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"Dimensions", "[", "Ab", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Assuming", "[", 
  RowBox[{
   RowBox[{"rb", ">", "0"}], ",", 
   RowBox[{"io", "/", "ib"}]}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8866584487634816`*^9, 3.8866584665472383`*^9}, {
   3.8866585067781096`*^9, 3.8866586506432905`*^9}, {3.886658682548439*^9, 
   3.8866587025052104`*^9}, {3.8866588276670036`*^9, 3.886659061639432*^9}, {
   3.8866591342081366`*^9, 3.88665925082027*^9}, {3.8866593281630964`*^9, 
   3.886659372252045*^9}, {3.886659425757382*^9, 3.8866594674432373`*^9}, {
   3.886659553581417*^9, 3.886659679197792*^9}, {3.8866597234221177`*^9, 
   3.886659810141148*^9}, {3.8866599235386252`*^9, 3.886659981124962*^9}, {
   3.8866600847497034`*^9, 3.8866601345417724`*^9}, {3.886660191839018*^9, 
   3.886660215082038*^9}, {3.8866602654582696`*^9, 3.8866603208190784`*^9}, {
   3.88666039660003*^9, 3.8866605329565506`*^9}, 3.886660571538189*^9, {
   3.8866607188458104`*^9, 3.886660834551864*^9}, {3.8866609257547665`*^9, 
   3.8866610215250072`*^9}, {3.8866610607017484`*^9, 3.886661177283549*^9}, {
   3.8866612258378077`*^9, 3.886661254290206*^9}, {3.8866613181214447`*^9, 
   3.8866613254569225`*^9}, {3.8866613771852655`*^9, 
   3.8866614362101526`*^9}, {3.8866615204190755`*^9, 
   3.8866615600759964`*^9}, {3.8866616072687798`*^9, 
   3.8866616127596645`*^9}, {3.8866616636964397`*^9, 
   3.8866616656935444`*^9}},ExpressionUUID->"78d69af2-8354-4bd3-966d-\
4301e532bb6c"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.8866614671805005`*^9, 3.886661564363763*^9}},
 CellLabel->
  "Out[116]=",ExpressionUUID->"7b634fac-f6b5-43c5-a947-93b4b4c8e10a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Ao", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "0", " ", ",", "0", " ",
          ",", "0", ",", " ", "0", " ", ",", "0"}], "}"}], "}"}], 
      "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ab", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",", 
          RowBox[{"-", "1"}], " ", ",", "0", ",", " ", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",", 
          RowBox[{"-", "1"}], " ", ",", "0"}], "}"}]}], "}"}], 
      "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"As", "=", 
     RowBox[{"SparseArray", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", " ", "1"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", "1"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}], "\[Rule]", "1"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "2"}], "}"}], "\[Rule]", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "4"}], "}"}], "\[Rule]", "1"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"4", ",", "3"}], "}"}], "\[Rule]", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"5", ",", "5"}], "}"}], "\[Rule]", "1"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"6", ",", "4"}], "}"}], "\[Rule]", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"6", ",", "6"}], "}"}], "\[Rule]", "1"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"7", ",", "5"}], "}"}], "\[Rule]", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"7", ",", "6"}], "}"}], "\[Rule]", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"7", ",", "7"}], "}"}], "\[Rule]", "1"}]}], "}"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outcurrent", "[", 
     RowBox[{"xs_", ",", "Ao_", ",", "Ab_", ",", "As_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "=", 
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{"1", ",", 
              RowBox[{
               RowBox[{"Dimensions", "[", "Ab", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "xs"}], "]"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"A", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"Ao", ",", "Ab", ",", 
           RowBox[{"Normal", "[", "As", "]"}], ",", "2"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Y", "=", 
         RowBox[{
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              FractionBox["1", "Ro"], "}"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               FractionBox["1", "rb"], ",", 
               RowBox[{
                RowBox[{"Dimensions", "[", "Ab", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               FractionBox["1", "rs"], ",", 
               RowBox[{
                RowBox[{"Dimensions", "[", "As", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "]"}], ".", 
          "x"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yn", "=", 
         RowBox[{"A", ".", "Y", ".", 
          RowBox[{"A", "\[Transpose]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Us", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"-", "ub"}], ",", 
               RowBox[{
                RowBox[{"Dimensions", "[", "Ab", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"Dimensions", "[", "As", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "}"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Is", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"Dimensions", "[", "Ab", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"Dimensions", "[", "As", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "}"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Isn", "=", 
         RowBox[{
          RowBox[{"A", ".", "Y", ".", "Us"}], "-", 
          RowBox[{"A", ".", "Is"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Un", "=", 
         RowBox[{
          RowBox[{"Inverse", "[", "Yn", "]"}], ".", "Isn"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"U", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"A", "\[Transpose]"}], ".", "Un"}], "//", "Simplify"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Ia", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Y", ".", "U"}], "-", 
            RowBox[{"Y", ".", "Us"}], "+", "Is"}], "/.", 
           RowBox[{"{", 
            RowBox[{"rs", "\[Rule]", "0"}], "}"}]}], "//", "Simplify"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"io", "=", 
         RowBox[{"First", "[", 
          RowBox[{"Ia", "//", "Flatten"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ib", "=", 
         RowBox[{"Max", "[", 
          RowBox[{"Part", "[", 
           RowBox[{"Ia", ",", 
            RowBox[{"2", ";;", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"Dimensions", "[", "Ab", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}]}], "]"}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Assuming", "[", 
       RowBox[{
        RowBox[{"rb", ">", "0"}], ",", 
        RowBox[{"io", "/", "ib"}]}], "]"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8866617021723595`*^9, 3.886662014926988*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"6cc93da6-b824-458a-983b-f561a06419f7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"outcurrent", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "1", ",", "1"}],
     "}"}], ",", "Ao", ",", "Ab", ",", "As"}], "]"}]], "Input",
 CellChangeTimes->{{3.8866620041401176`*^9, 3.88666205559433*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"2ab9c51b-6fc5-4cdb-9b87-345455d84cd2"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.8866620500933533`*^9, 3.8866620620886407`*^9}},
 CellLabel->
  "Out[127]=",ExpressionUUID->"b88c8858-7821-40d9-8927-76faad657024"]
}, Open  ]]
},
WindowSize->{1152., 657.6},
WindowMargins->{{
  Automatic, -1157.3999999999996`}, {-169.79999999999995`, Automatic}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (2021\:5e742\:67085\
\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a40d0c5a-6299-4569-ab35-095f45245f51"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 3829, 109, 233, "Input",ExpressionUUID->"15836539-bacd-43c2-b76c-283ee17f8f33"],
Cell[4412, 133, 172, 2, 32, "Output",ExpressionUUID->"e920b8b3-26bc-402d-87e4-d3271604ea4b"]
}, Open  ]],
Cell[4599, 138, 5529, 155, 437, "Input",ExpressionUUID->"916ba182-4e61-4b44-8c99-c63675d79ea2"],
Cell[CellGroupData[{
Cell[10153, 297, 1317, 17, 28, "Input",ExpressionUUID->"bd316b44-da0a-4370-9528-2d7d7e79d1a5"],
Cell[11473, 316, 568, 16, 51, "Output",ExpressionUUID->"72ee00b5-0234-436f-9e61-ef881dab1424"]
}, Open  ]],
Cell[12056, 335, 226, 4, 28, "Input",ExpressionUUID->"b49b96b8-24f7-49a8-bc12-7c8db10bc356"],
Cell[12285, 341, 451, 9, 44, InheritFromParent,ExpressionUUID->"831cfb24-50ec-4872-9ec7-ef5efb61628b"],
Cell[CellGroupData[{
Cell[12761, 354, 335, 7, 44, "Input",ExpressionUUID->"835c9e44-4f5a-40d3-a159-059a4ccf905f"],
Cell[13099, 363, 740, 22, 76, "Output",ExpressionUUID->"e1ece360-c4b8-4549-bcdf-94413d59c61d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13876, 390, 7817, 222, 599, "Input",ExpressionUUID->"78d69af2-8354-4bd3-966d-4301e532bb6c"],
Cell[21696, 614, 179, 3, 32, "Output",ExpressionUUID->"7b634fac-f6b5-43c5-a947-93b4b4c8e10a"]
}, Open  ]],
Cell[21890, 620, 7447, 200, 655, "Input",ExpressionUUID->"6cc93da6-b824-458a-983b-f561a06419f7"],
Cell[CellGroupData[{
Cell[29362, 824, 363, 8, 28, "Input",ExpressionUUID->"2ab9c51b-6fc5-4cdb-9b87-345455d84cd2"],
Cell[29728, 834, 181, 3, 55, "Output",ExpressionUUID->"b88c8858-7821-40d9-8927-76faad657024"]
}, Open  ]]
}
]
*)

