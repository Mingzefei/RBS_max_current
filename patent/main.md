title: 一种可重构电池系统最大许用电流计算方法

# 权利要求书

1. 一种可重构电池系统最大许用电流计算方法，其特征在于，包括以下步骤：

**步骤1：** 设待求解的可重构电池系统中电池数量为$N_b$，开关数量为$N_s$。基于该系统的电池和开关连接关系，构建具有物理信息的有向图模型。

**步骤2：** 根据步骤1中构建的有向图模型，以开关状态为变量，各电池流经电流不超过电池许用电流为约束条件，系统输出电流为目标函数，建立优化模型。

**步骤3：** 基于步骤1中构建的有向图模型，对其中的$N_b$个电池分别求解对应的最短通路，其中通路$p$的距离通过下式计算得到：
$$
   \omega(p) = N_s \cdot n_b (p) + n_s (p),
$$
其中，$n_b$为通路中电池数量，$n_s$为通路中开关的数量。

**步骤4：** 设选取的最短通路数量为$N_{set}$，其初始值为$N_b$。

**步骤5：** 从步骤3中求解得到的$N_b$条最短通路中组合选取$N_{set}$条通路，生成$C^{N_{set}}_{N_b}$种组合方式。

**步骤6：** 对步骤5中生成的每一种组合方式，将被选入通路的开关状态设置为闭合，其余开关状态设置为断开，带入步骤2中建立的优化模型，判断是否满足约束条件。若满足，则该组合方式下的系统输出电流；否则舍弃。

**步骤7：** 从步骤6中满足约束条件的组合方式中，选取输出电流最大的组合方式，记录此时的系统最大许用电流值。

**步骤8：** 使用如下规则更新步骤4中的$N_{set}$的值，重复步骤5至步骤7：
- 若当前系统最大许用电流值为第一次记录，则使用$N_{set}/2$的最近整数值更新$N_{set}$的值；
- 若当前系统最大许用电流值大于前一次系统许用电流值，则使用二分法向上更新整数$N_{set}$的值；
- 若当前系统最大许用电流值等于前一次系统许用电流值，则终止计算，输出系统最大许用电流值；
- 若当前系统最大许用电流值小于前一次系统许用电流值，则使用二分法向下更新整数$N_{set}$的值。

2. 如权利要求1所述的可重构电池系统最大许用电流计算方法，其特征在于，所述步骤1中的“基于该系统的电池和开关连接关系，构建具有物理信息的有向图模型”进一步包括以下内容：

- 该有向图模型中的节点对应实际可重构电池系统中组件（即电池和开关）之间的连接点。
- 该有向图模型中的边对应实际可重构电池系统中的电池、开关和外部负载。其中电池用从电池负极指向电池正极的有向边表示；开关用一对方向相反的有向边表示；外部负载用从系统正极指向负极的有向边表示。
- 该有向图模型中的边都被分配了两个属性，电压差和电阻。

3. 如权利要求1所述的可重构电池系统最大许用电流计算方法，其特征在于，所述步骤2中的“根据步骤1中构建的有向图模型，以开关状态为变量，各电池流经电流不超过电池许用电流为约束条件，系统输出电流为目标函数，建立优化模型”进一步包括以下内容：

**步骤21：** 根据**步骤1**中构建的有向图模型，按以下关系确定关联矩阵$A$：
$$
   a_{kl}=
   \begin{cases}
      1,  & \text{边$l$离开节点$k$},\\
      -1, & \text{边$l$进入节点$k$},\\
      0,  & \text{其他}.
   \end{cases}
$$

**步骤22：** 根据有向图模型中每个有向边的具体含义，对关联矩阵按列进行归类整理。将其中表示开关的列，以互为相反的两列为一组，每组仅保留一列；删去所有列的最后一行，得到简化关联矩阵$\tilde{A}=[\tilde{A}_b\,\tilde{A}_s\,\tilde{A}_o]$。其中，$\tilde{A}_b$，$\tilde{A}_s$和$\tilde{A}_o$分别对应电池、开关和外部负载。

**步骤23：** 设系统中$N_s$个开关的状态为$X_s$，是一个$N_s$阶方阵，其对角线上的元素为1或0，分别表示开关闭合或断开；其非对角线上的元素均为0。

**步骤24：** 系统中$N_b$个电池的电流用下式计算得到：
$$
   I_b = \frac{1}{r_b^2}[\tilde{A}_b^\mathrm{T} Y_n^{-1}(X_s) \tilde{A}_b U_b -r_b U_b],
$$
其中，$I_b$为电池电流，$r_b$为电池内阻，$U_b$为电池电压，$I_{b,max}$为电池最大许用电流，$Y_n(X_s)$为系统节点电导矩阵，其通过下式计算得到：
$$
   Y_n (X_s) = \frac{1}{R_o} \tilde{A}_o\tilde{A}_o^\mathrm{T} + \frac{1}{r_b} \tilde{A}_b \tilde{A}_b^\mathrm{T} + \frac{1}{r_s}\tilde{A}_s\bm{X}_s \tilde{A}_s^\mathrm{T}.
$$
其中，$R_o$为外部负载电阻，$r_s$为开关内阻。

**步骤25：** 系统的输出电流用下式计算得到：
$$
   I_b = \frac{1}{r_b^2}[\tilde{A}_b^\mathrm{T} Y_n^{-1}(X_s) \tilde{A}_b U_b -r_b U_b].
$$

**步骤26：** 基于**步骤24**和**步骤25**，最终得到如下形式的优化模型：
$$
   \max I(X_s) \\
   \text{s.t.} \max (I_b) \leq I_{b,\max}.
$$

# 说明书

## 所属技术领域

## 背景技术

## 发明内容

## 附图说明

## 具体实施方式

# 说明书摘要
